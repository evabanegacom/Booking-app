# Booking-app (Backend)

> This is the Server side of a technical support application. This app is built to connect cars to people who need cars for hire. using this app as a case study. The client-side implementation can be found [here](https://github.com/evabanegacom/Frontend-booking.git)

## Built With

- Ruby v2.6.5
- Ruby on Rails 5.2.4.4
- Rspec
- JWT
- Heroku

## Core Functionalities

- **User authentication:** allows new user to register and existing users to login.
- **Fetch all cars:** enables users to view available cars and their individual details.
- **Fetch all bookings:** enables users to view existing bookings, both past and future.
- **Create new booking:** allows users to book a new booking.

## Getting Started

To get a local copy up and running follow these simple example steps.

- On the project GitHub page, navigate to the main page of the repository [this page](https://github.com/evabanegacom/Frontend-booking.git).
- Under the repository name, locate and click on a green button named `Code`.
- Copy the project URL as displayed.
- If you're running Windows Operating System, open your command prompt. On Linux, Open your terminal.
- Change the current working directory to the location where you want the cloned directory to be made. Leave as it is if the current location is where you want the project to be.
- Type `git clone`, and then paste the URL you copied in Step 3.<br>
  `$ git clone https://github.com/evabanegacom/Frontend-booking.git` <em>Press Enter key</em><br>
- Press Enter. Your local copy will be created.

## Prerequisites

- [Git](https://gist.github.com/derhuerst/1b15ff4652a867391f03).
- Web browser (Chrome/Firefox)
- [Node](https://nodejs.org/en/)
- [NPM](https://www.npmjs.com/get-npm)
- Ruby v2.7.1
- Ruby on Rails v6
- Postgresql v >= 9.5

## Project Setup

_After cloning, the following steps setup the project_

- `cd Booking-app` to change the current working directory.
- `git checkout development` to access the most recent files and features.
- `bundle install` to install all necessary dependencies.
- `rails db:create` && `rails db:migrate` to create database and tables.
- `rails db:seed` to populate database with Dummie data.
- `though i made a user an admin to create the cars data. you can also do that if you want`
- `rails s` to start the application. You're all set.
  Feel free to use POSTMAN or any other similar infrastructure to test the different endpoints.

  To run test suites included, run:

- `bundle exec rspec`

## API Documentation

> The base URL for all endpoints is `https://gothic-serpent.herokuapp.com/api/v1/`. Some requests requires validation while some does not. The validation is implemented using tokens generated by JWT upon registration or login. This token is then sent with the headers of the requests that requires validation, so that it can be decoded and the app can determine if the token is valid or not. If valid, the user can successfully access such end-points that requires authentication.

**Summary of Available API Endpoints**
| Endpoint | Feature | Authentication |
| ------------ | ------------| ---------- |
| POST /users | Registers a new user | False |
| POST /login | Logs in a user | False |
| GET /autologin | Checks login status of the current user | True |
| POST /bookings | Creates a new booking | True |
| GET /bookings | Fetches all available booking for logged user | True |
| GET /cars | Fetches all available cars | False |
| GET /cars/:id | Fetches the details of a specific car | False |

**Sampling a request that requires authentication**

_Fetch bookings: endpoint fetches all the bookings already booked by the logged in user. Therefore, it requires authorization._

Endpoint: `https://gothic-serpent.herokuapp.com/api/v1/bookings`

Request (from POSTMAN):

```js
token = 'eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxfQ.JC6qKuH9SG0SIiYSfhZUFTtirxN9Q47buLk0DPFFFzE'
curl --location --request GET 'https://gothic-serpent.herokuapp.com/api/v1/bookings' \
--header 'Authorization: Bearer <token>' \
```

Response:

```json
[
  {
    "date_created": "2020-12-08T11:14:06.414Z",
    "id": 6,
    "date": "2020-12-09T13:15:00.000Z",
    "description": "I need a car for my wedding",
    "duration": "90",
    "car_id": 2,
    "city": "madrid",
    "username": "precious"
  }
]
```

**Sampling a request that DOES NOT require authentication**

_Login: endpoint fetches creates a new token and ensure that the user can access all features._

Endpoint: `https://gothic-serpent.herokuapp.com/api/v1/login`

Request (From POSTMAN):

```js
curl --location --request POST 'https://gothic-serpent.herokuapp.com/api/v1/login' \
--form 'emaill="johndoe@yahoo.com"' \
--form 'password="password"'
```

Response:

```json
{
  "user": {
    "id": 1,
    "name": "John Doe",
    "email": "john@doe.com"
  },
  "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxfQ.JC6qKuH9SG0SIiYSfhZUFTtirxN9Q47buLk0DPFFFzE",
  "logged_In": true
}
```

## Deployment

This app was deployed to Heroku and is accessible at: `https://gothic-serpent.herokuapp.com`

## Author

üë§ **Precious**

- Github: [@evabanegacom](https://github.com/evabanegacom)

## ü§ù Contributing

Contributions, issues and feature requests are welcome!

Feel free to check the [issues page](https://github.com/evabanegacom/Booking-app/issues/).

## Show your support

Give a ‚≠êÔ∏è if you like this project!

## Acknowledgments

- [Microverse](https://.microverse.org/)
- [Reinald Reynoso's articles medium](https://medium.com/better-programming/build-a-rails-api-with-jwt-61fb8a52d833)
- [Images stored with Cloudinary](https://cloudinary.com/)

## üìù License

This project is [MIT](/LICENSE) licensed.